{
  "data": {
    "n_stocks": 2000,
    "window_length": 504,
    "n_features": 2,
    "vol_window": 252,
    "vix_lookback_percentile": 80.0,
    "min_valid_fraction": 0.8,
    "data_source": "synthetic",
    "data_dir": "data/",
    "training_stride": 21
  },
  "vae": {
    "K": 75,
    "sigma_sq_init": 1.0,
    "sigma_sq_min": 0.0001,
    "sigma_sq_max": 10.0,
    "window_length": 504,
    "n_features": 2,
    "r_max": 5.0,
    "dropout": 0.3
  },
  "loss": {
    "mode": "P",
    "gamma": 3.0,
    "lambda_co_max": 0.5,
    "beta_fixed": 1.0,
    "warmup_fraction": 0.2,
    "max_pairs": 2048,
    "delta_sync": 21
  },
  "training": {
    "max_epochs": 500,
    "batch_size": 512,
    "learning_rate": 0.005,
    "weight_decay": 0.001,
    "adam_betas": [
      0.9,
      0.999
    ],
    "adam_eps": 1e-08,
    "patience": 50,
    "es_min_delta": 1,
    "lr_patience": 30,
    "lr_factor": 0.75,
    "n_strata": 15,
    "curriculum_phase1_frac": 0.3,
    "curriculum_phase2_frac": 0.3,
    "gradient_accumulation_steps": 1,
    "gradient_checkpointing": false,
    "compile_model": true
  },
  "inference": {
    "batch_size": 512,
    "au_threshold": 0.01,
    "r_min": 2,
    "aggregation_method": "mean",
    "aggregation_half_life": 60
  },
  "risk_model": {
    "winsorize_lo": 5.0,
    "winsorize_hi": 95.0,
    "d_eps_floor": 1e-06,
    "conditioning_threshold": 1000000.0,
    "ridge_scale": 1e-06,
    "sigma_z_shrinkage": "spiked",
    "sigma_z_eigenvalue_pct": 0.95,
    "sigma_z_ewma_half_life": 252,
    "b_a_shrinkage_alpha": 0.0,
    "use_wls": true,
    "b_a_normalize": true,
    "market_intercept": true
  },
  "portfolio": {
    "lambda_risk": 252.0,
    "w_max": 0.03,
    "w_min": 0.001,
    "w_bar": 0.03,
    "phi": 0.0,
    "kappa_1": 0.1,
    "kappa_2": 7.5,
    "delta_bar": 0.01,
    "tau_max": 0.3,
    "n_starts": 3,
    "sca_max_iter": 100,
    "sca_tol": 1e-08,
    "armijo_c": 0.0001,
    "armijo_rho": 0.5,
    "armijo_max_iter": 20,
    "max_cardinality_elim": 100,
    "entropy_eps": 1e-30,
    "cardinality_method": "auto",
    "alpha_grid": [
      0,
      0.001,
      0.005,
      0.01,
      0.02,
      0.05,
      0.1,
      0.2,
      0.5,
      1.0,
      2.0,
      5.0
    ],
    "momentum_enabled": false,
    "momentum_lookback": 252,
    "momentum_skip": 21,
    "momentum_weight": 0.5,
    "entropy_idio_weight": 0.05,
    "target_enb": 0.0,
    "transaction_cost_bps": 10.0
  },
  "walk_forward": {
    "total_years": 35,
    "min_training_years": 10,
    "oos_months": 6,
    "embargo_days": 21,
    "holdout_years": 3,
    "val_years": 2,
    "score_lambda_pen": 5.0,
    "score_lambda_est": 2.0,
    "score_mdd_threshold": 0.2
  },
  "seed": 42,
  "_diagnostic": {
    "profile": "full",
    "data_source": "tiingo",
    "n_stocks_actual": 788,
    "n_dates_actual": 7874,
    "date_range": "1995-01-03 to 2026-02-13",
    "pipeline_time_seconds": 1509.201466507,
    "holdout_fraction": 0.2,
    "loss_mode": "P"
  }
}